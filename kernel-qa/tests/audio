# setup test01 test02 test03 test04
# dependency: vorbis-tools alsa-utils

setup() {
    oggdec -Q -o $TEMPDIR/ignore.audio.wav /usr/share/sounds/ubuntu/stereo/desktop-login.ogg 2>&1 1>/dev/null
}

test01() {
    TEST="Audio-01: Audio playback through speakers"
    tst_prompt "
\n
You are about to test audio playback through your PC speakers.
When you run this test, the Ubuntu startup sound will be played.
\n
    "

    case $? in 
    0) # yes
        tst_msg "\nThe sound is playing now.\n" 0
        aplay -q $TEMPDIR/ignore.audio.wav
        tst_result_prompt "
\n
Was the Ubuntu startup sound played through the speakers?
\n
    "
         
        tst_reslog $? "pulseaudio" ;;
    *)
        tst_skip ;;
    esac
    return
}


test02() {
    TEST="Audio-02: Audio playback through headphones"
    tst_prompt "
\n
You are about to test audio playback through your headphone speakers.
When you run this test Ubuntu startup sound will be played
through your headphone speakers. Please plug in your headphones now.
\n
    "

    case $? in 
    0) # yes
        tst_msg "\nThe sound is playing now.\n" 0
        aplay -q $TEMPDIR/ignore.audio.wav
        tst_result_prompt "
\n
Was the Ubuntu startup sound played through the headphone speakers?
\n
    "

        tst_reslog $? "pulseaudio" ;;
    *) # no or Esc
        tst_skip ;;
    esac
    return
}


test03() {
    TEST="Audio-03:Audio Record through builtin mic"
    tst_prompt "
\n
You are about to test audio recording through built-in microphone.
Please skip this test if the previous sound playback tests have failed.
\n
\n
You will be prompted to speak into the built-in mic for 5 seconds,
and the sound that was recorded will be played back to you.
\n
    "

    case $? in 
    0) # yes
        tst_msg "\nStart recording now..." 0
        arecord -q -d 5 -f cd -t wav $TEMPDIR/ignore.foobar.wav
        tst_msg "\nThe recording is playing back now."  0
        aplay -q $TEMPDIR/ignore.foobar.wav
        tst_result_prompt "
\n
Was the sound you recorded played back to you?
\n
    "

        tst_reslog $? "pulseaudio" ;;
    *) # no or Esc
        tst_skip ;;
    esac
    return
}


test04() {
    TEST="Audio-04:Audio Record through external mic"
    tst_prompt "
\n
You are about to test audio recording through external microphone.
Please skip this test if the previous sound playback tests have failed.
\n
\n
You will be prompted to speak into the external mic for 10 seconds,
and the sound that was recorded will be played back to you.
\n
\n
Start the test once you have plugged in your external microphone.
\n
    "

    case $? in 
    0) # yes
        tst_msg "\nStart Recording audio now..." 0
        arecord -q -d 5 -f cd -t wav $TEMPDIR/ignore.foobar.wav
        tst_msg "\nThe recording is playing back now."  0
        aplay -q $TEMPDIR/ignore.foobar.wav
        tst_result_prompt "
\n
Was the sound you recorded played back to you?
\n
    "
        tst_reslog $? "pulseaudio" ;;
    *) # no or Esc
        tst_skip ;;
    esac
    return
}

# vi:set ts=4 sw=4 expandtab:
