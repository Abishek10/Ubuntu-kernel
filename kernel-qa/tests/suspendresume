# test01
# dependency package: none

test01() {
    TEST="SuspendResume-01:Auto Suspend to RAM and Auto Resume"
    tst_prompt "
\n
You are about to test suspend to RAM and resume functionlity.
When you run this test, your system will suspend to RAM
and  then resume within 30seconds. 
\n 
\n
If your system fails to resume or display comes up blank, you 
may have to reboot, re-run the testsuite and skip this test.
\n
    "

    case $? in 
    0) # yes
        tst_msg "\nYour system will suspend to RAM in 2sec..." 2
        alarmdev="/sys/class/rtc/rtc0/wakealarm"
	time=$(date '+%s' -d "+25 seconds")
        sudo echo "0" > $alarmdev
        sudo echo $time > $alarmdev
        sudo pm-suspend
        tst_dmesg

        tst_result_prompt "
\n
Did the system resume correctly after suspend to RAM? 
\n
    "
        tst_reslog $? "linux" 

        TEST="SuspendResume-02: Network Re-connect After Resume"
        tst_msg "Waiting 5s more for network to resume connection" 7
        tst_result_prompt "
\n
Did the network manager re-connect after resume?
\n
    "
        tst_reslog $? "linux" ;;
    *)
        tst_skip ;;
    esac
    return
}
