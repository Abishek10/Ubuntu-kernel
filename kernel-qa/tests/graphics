# test01 test02 test03
# dependency package: none

test01() {
    TEST="Graphics-01:KMS - Virtual Terminal Switching"
    tst_prompt "
\n
You are about to test virtual terminal switching, this 
will test KMS and XORG. 
\n
\n
When you run this test the display will switch from Terminal 7 
to Terminal 1 and back. In the event that this test fails, 
you may have to manually switch to Terminal 7 using Ctrl+Alt+Fn7. 
In the worst case, please reboot, re-run this testsuite and skip this test. 
\n
    " 

    case $? in 
    0) # yes
        tst_msg "\nYour display will switch to VT1 in 2sec..." 2
        sudo chvt 1; sleep 2; sudo chvt 7;
        tst_dmesg
        tst_result_prompt "
\n
Did your video switch to virtual terminal 1 and then back again?
\n
\n
    "

        tst_reslog $? "xorg" ;;
    *)
        tst_skip ;;
    esac
    return
}


test02() {
    TEST="Graphics-02:Monitor Power Saving Mode"
    tst_prompt "
\n
You are about to test the monitor power saving mode. When you run this test 
your monitor will go completely blank, and remain blank until you move the mouse
or hit any key. 
\n
    "

    case $? in 
    0) # yes
        tst_msg "\nDisplay will go blank in 2sec..." 2
        xset dpms force off

        tst_dmesg
        tst_result_prompt "
\n
Did the display go blank and resume when you moved the mouse?
\n
\n
"
        tst_reslog $? "xorg" ;;
    *) # no or Esc
        tst_skip ;;
    esac
    return
}


test03() {
    TEST="Graphics-03:Video Resolution mode Switching"
    tst_prompt "
\n
You are about to run a video resolution mode switching test.
When you run this test, your display will cycle through all the
video resolution modes supported by your system. The modes should
cycle from the highest to the lowest and back original setting.
\n
\n
In case this test fails, you will need to reset your display to
the original setting manually.
\n
"
    
    case $? in 
    0) # yes
        tst_msg "\nYour display will start switching mode in 2secs..." 2
        $TESTDIR/xrandr_cycle 
        
        tst_dmesg
        tst_result_prompt "
\n
Did the display switch resolution modes? 
Did your desktop return back to its original condition?
\n
\n
    " 
        tst_reslog $? "xorg" ;;
    *) # no or Esc
        tst_skip ;;
    esac
    return
}
