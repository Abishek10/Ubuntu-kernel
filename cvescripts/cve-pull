#!/usr/bin/python
#==============================================================================
# Author: Stefan Bader <stefan.bader@canonical.com>
# Copyright (C) 2010
#
# This script is distributed under the terms and conditions of the GNU General
# Public License, Version 3 or later. See http://www.gnu.org/copyleft/gpl.html
# for details.
#==============================================================================
import sys, os
import optparse
from cvescripts_lib import *
import cve_lib

parser = optparse.OptionParser()
parser.set_description(
	"Update the ubuntu-cve-tracker branch to get the latest data.")
(opt, args) = parser.parse_args()

#------------------------------------------------------------------------------
# Now with the path to the ubuntu-cve-tracker we can import libraries from
# them.
#------------------------------------------------------------------------------
try:
	TrackerPull()
except:
	print "EE: Failed to update cve-tracker branch!"
	sys.exit(1)
else:
	pass

owd = os.getcwd()
if kernel_reference != "":
	try:
		os.chdir(kernel_reference)
		print "II: Updating upstream kernel reference..."
		os.system("git fetch")
	except:
		print "EE: Failed to update upstream Linux tree!"
		sys.exit(1)

os.chdir(owd)
for area in ListWorkareas():
	print "II: Updating " + area
	os.chdir(area)
	os.system("git remote update")
	os.chdir(owd)

