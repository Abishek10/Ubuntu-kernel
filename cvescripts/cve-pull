#!/usr/bin/python
#==============================================================================
# Author: Stefan Bader <stefan.bader@canonical.com>
# Copyright (C) 2010
#
# This script is distributed under the terms and conditions of the GNU General
# Public License, Version 3 or later. See http://www.gnu.org/copyleft/gpl.html
# for details.
#==============================================================================
import sys, os
import optparse
import cvescripts_lib
import cve_lib

parser = optparse.OptionParser()
parser.set_description(
	"Update the ubuntu-cve-tracker branch to get the latest data.")
(opt, args) = parser.parse_args()

#------------------------------------------------------------------------------
# Now with the path to the ubuntu-cve-tracker we can import libraries from
# them.
#------------------------------------------------------------------------------
owd = os.getcwd()
try:
	os.chdir(cvescripts_lib.cvetracker_dir)
	os.system("bzr pull -q")
except:
	print "EE: Failed to update cve-tracker branch!"
	os.chdir(owd)
	sys.exit(1)
else:
	pass

if cvescripts_lib.kernel_reference != "":
	try:
		os.chdir(cvescripts_lib.kernel_reference)
		os.system("git fetch")
	except:
		print "EE: Failed to update upstream Linux tree!"
		sys.exit(1)
	else:
		pass

os.chdir(owd)


