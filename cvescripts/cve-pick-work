#!/usr/bin/python
#==============================================================================
# Author: Stefan Bader <stefan.bader@canonical.com>
# Copyright (C) 2010
#
# This script is distributed under the terms and conditions of the GNU General
# Public License, Version 3 or later. See http://www.gnu.org/copyleft/gpl.html
# for details.
#==============================================================================
import sys, os, re
import optparse
import cvescripts_lib
import cve_lib

class FindLinux:
	pkgfamily = ['linux']
	packages = ['linux']
	debug = 0

releases = cve_lib.releases
for eol in cve_lib.eol_releases:
	if eol in releases:
		releases.remove(eol)

owd = os.getcwd()
try:
	os.chdir(cvescripts_lib.cvetracker_dir)
	(cves, uems) = cve_lib.get_cve_list()
	opt = FindLinux()
	(table, prio, cves, nmap, info) = cve_lib.load_table(cves, uems, opt)
except:
	print "EE: Failed to query CVEs!"
	os.chdir(owd)
	sys.exit(1)
else:
	pass
os.chdir(owd)

for cve in sorted(cves):
	if not table.has_key(cve):
		continue
	print cve
	for pkg in sorted(table[cve].keys()):
		print " - " + pkg
