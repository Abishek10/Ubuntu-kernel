#!/usr/bin/python
#==============================================================================
# Author: Stefan Bader <stefan.bader@canonical.com>
# Copyright (C) 2010
#
# This script is distributed under the terms and conditions of the GNU General
# Public License, Version 3 or later. See http://www.gnu.org/copyleft/gpl.html
# for details.
#==============================================================================
import sys, os, re
import optparse
from cvescripts_lib import *

owd = os.getcwd()
os.chdir(tracker_dir)
try:
	(cves, uems) = cve_lib.get_cve_list()
except:
	print "EE: Failed to query CVEs!"
	os.chdir(owd)
	sys.exit(1)


for cve in sorted(cves):
	cvefile = cve_lib.find_cve(cve)
	wi = WorkItem(cvefile)
	valid = False
	for (pkg, series) in ListLinuxPackagesAndSeries():
		if wi.is_pkg_waiting(pkg, series):
			valid = True
			break
		if wi.is_pkg_pending(pkg, series):
			valid = True
			break
	if not valid:
		cves.remove(cve)

for cve in sorted(cves):
	print cve

os.chdir(owd)
