#!/bin/bash

config="$1"
devel="$2"
cve_list="$3"
shift 3

while read series cvebranch repo branch flags X
do
	tos=",${flags},"
	tos="${tos#*,transfer-pending:}"
	tos="${tos%%,*}"
	tos=`echo "$tos" | sed -e 's@/@ @g'`

	[ "$tos" = "" ] && continue

	echo "transfer pending ${series}_${cvebranch} -> $tos" 1>&2

	grep " ${series} ${cvebranch} " "$cve_list" |
		while read file d1 d2 d3 state
		do
			case "$state" in
			pending|released)
				for to in $tos
				do
					to=`echo "$to" | sed -e 's/_/ /'`
					echo "$file $to - pending"
				done
				;;
			esac
		done
done <"$config"
