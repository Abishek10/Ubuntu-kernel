--- common/lib/modules/fglrx/build_mod/firegl_public.c	2008-01-17 11:48:59.000000000 -0500
+++ common/lib/modules/fglrx/build_mod/firegl_public.c	2008-01-28 07:36:07.000000000 -0500
@@ -1185,7 +1185,11 @@ unsigned int ATI_API_CALL KCL_ProcessIsT
    int process_terminated = 1;
   
 #if LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,17)  
+#if !defined(CONFIG_PREEMPT_RT) && !defined(CONFIG_XEN)
    rcu_read_lock();
+#else
+   preempt_disable();
+#endif
 #else   
    read_lock(&tasklist_lock);
 #endif   
@@ -1202,7 +1206,11 @@ unsigned int ATI_API_CALL KCL_ProcessIsT
       }
    }   
 #if LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,17)  
+#if !defined(CONFIG_PREEMPT_RT) && !defined(CONFIG_XEN)
    rcu_read_unlock();
+#else
+   preempt_enable();
+#endif
 #else   
    read_unlock(&tasklist_lock);
 #endif   
