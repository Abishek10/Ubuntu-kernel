--- a/net/mac80211/ieee80211.c	2007-11-15 19:49:57.000000000 +0800
+++ b/net/mac80211/ieee80211.c	2007-11-15 19:49:37.000000000 +0800
@@ -2552,6 +2552,9 @@ static void ieee80211_if_shutdown(struct
 			cancel_delayed_work(&local->scan_work);
 		}
 		flush_workqueue(local->hw.workqueue);
+
+		kfree(sdata->u.sta.extra_ie);
+		sdata->u.sta.extra_ie = NULL;
 		break;
 	}
 }
