diff --git a/net/mac80211/ieee80211_sta.c b/net/mac80211/ieee80211_sta.c
index de63f46..8feacbd 100644
--- a/net/mac80211/ieee80211_sta.c
+++ b/net/mac80211/ieee80211_sta.c
@@ -2203,6 +2203,16 @@ static void ieee80211_rx_bss_info(struct net_device *dev,
 
 		mode = local->sta_sw_scanning ?
 		       local->scan_hw_mode : local->oper_hw_mode;
+		if (local->sta_hw_scanning) {
+
+			list_for_each_entry(mode, &local->modes_list, list) {
+				if (mode->mode == rx_status->phymode)
+					break;
+			}
+			if (mode == NULL)
+				mode = local->oper_hw_mode;
+
+		}
 		rates = mode->rates;
 		num_rates = mode->num_rates;
 
